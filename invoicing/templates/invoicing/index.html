{% extends 'invoicing/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load tailwind_filters %}
{% load widget_tweaks %}

{% block title %}
<h1 class="text-3xl bold  p-2  mb-2">Tableau de bord</h1>
{% endblock title%}

{% block content %}
    <div class="grid grid-cols-4 gap-2">
        <div class="text-center">
            <h2 class="text-xl mb-2 bg-slate-600 p-2 rounded">Sociétés ({{ companies.count  }})</h2>
            <select class="w-full p-2 " size="15" name="companies" id="companies" onclick="get_id(this)">
                {% for company in companies %}
                    {% if company.is_active == False %}
                        <option class="p-1 text-red-800" value="{{ company.id }}">
                    {% else %}
                        <option class="p-1 text-slate-600" value="{{ company.id }}">
                    {% endif %}
                    {{ company.name }}</option>
                {% endfor %}
            </select>
            <div class="grid grid-cols-4 gap-1 m-2">
                <a class="w-full px-2 bg-green-400 text-green-800 rounded"
                   hx-get="{% url 'invoicing:create-company' %}"
                   hx-target="#content"
                   hx-swap="innerHTML"
                   hx-push-url="true">
                    Ajouter
                </a>
                <form hx-get="{% url 'invoicing:update-company' 0 %}"
                        hx-vals='js:{"company_id": document.getElementById("companies").value}'
                        hx-target="#content"
                       hx-swap="innerHTML"
                       hx-push-url="true">
                    <button
                        class="w-full px-2 bg-blue-400 text-blue-800 rounded">Modifier</button>
                </form>

                <button hx-get="{% url 'invoicing:deactivate-company' 0 %}"
                        hx-confirm="Are you sure ?"
                        hx-vals='js:{"company_id": document.getElementById("companies").value}'
                class="w-full px-2 bg-red-400 text-red-800 rounded">Désactiver</button>
                <button class="w-full px-2 bg-purple-400 text-red-800 rounded">Facturer</button>
            </div>
        </div>
        <div class="text-center">
            <h2 class="text-xl mb-2 bg-slate-400 p-2 rounded">Clients ({{ customers.count  }})</h2>
            <select class="w-full p-2" size="15">
                {% for customer in customers %}
                    <option class="p-1 text-slate-600" value="{{ customer.id }}">{{ customer.lastname }} {{ customer.firstname }}</option>
                {% endfor %}
            </select>
            <div class="grid grid-cols-4 gap-1 m-2">
                <button class="w-full px-2 rounded bg-green-400 text-green-800">Ajouter</button>
                <button class="w-full px-2 rounded bg-blue-400 text-blue-800">Modifier</button>
                <button class="w-full px-2 rounded bg-red-400 text-red-800">Désactiver</button>
                <button class="w-full px-2 rounded bg-purple-400 text-red-800">Facturer</button>
            </div>
        </div>
        <div class="text-center">
            <h2 class="text-xl mb-2 bg-slate-400 p-2 rounded">Factures ({{ invoices.count  }})</h2>
            <select class="w-full p-2" size="15">
                {% for invoice in invoices %}
                    {% if invoice.status == "quotation" %}
                        <option class="bg-red-400 p-1 text-slate-600" value="{{ invoice.id }}">{{ invoice.reference }} ({{ invoice.customer }})</option>
                    {% elif invoice.status == "command" %}
                        <option class="bg-blue-500 p-1 text-slate-600" value="{{ invoice.id }}">{{ invoice.reference }} ({{ invoice.customer }})</option>
                    {% elif invoice.status == "invoice" %}
                        <option class="bg-green-500 p-1 text-slate-600" value="{{ invoice.id }}">{{ invoice.reference }} ({{ invoice.customer }})</option>
                    {% endif %}
                {% endfor %}
            </select>
            <div class="grid grid-cols-2 gap-1 m-2">
                <button class="w-full px-2  bg-green-400 text-green-800 rounded">Ajouter</button>
                <button class="w-full px-2  bg-blue-400 text-blue-800 rounded">Modifier</button>
            </div>
        </div>
        <div class="text-center">
            <h2 class="text-xl mb-2 bg-slate-400 p-2 rounded">Lignes de facture</h2>
            <select class="w-full p-2" size="15">
                {% for line in invoice_lines %}
                    <option class="p-1 text-slate-600" value="{{ line.id }}">{{ line.invoice }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
{% endblock content%}